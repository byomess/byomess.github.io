<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Rhythm Game - Visual FX Update</title>
    <link rel="stylesheet" href="index.css">
</head>
<body>

    <div id="game-container">
        <!-- Menu Principal (com dois estados: boas-vindas e menu) -->
        <div id="main-menu">
            <div class="menu-background">
                <div class="particles"></div>
                <div class="gradient-overlay"></div>
            </div>
            
            <button id="settings-btn" class="settings-icon">
                <span class="settings-gear">⚙️</span>
                <div class="settings-tooltip">Configurações</div>
            </button>
            
            <!-- Estado de Boas-vindas -->
            <div id="welcome-state" class="menu-state">
                <div class="welcome-content">
                    <div class="welcome-logo-container">
                        <div class="logo-glow"></div>
                        <h1 id="welcome-title">
                            <span class="title-main">HYPE</span>
                            <span class="title-accent">HERO</span>
                        </h1>
                        <div class="welcome-subtitle">Rhythm Gaming Experience</div>
                    </div>
                    
                    <div class="welcome-prompt">
                        <span class="prompt-text-desktop">Clique para iniciar</span>
                        <span class="prompt-text-mobile">Toque para iniciar</span>
                    </div>
                </div>
            </div>
            
            <!-- Estado do Menu -->
            <div id="menu-state" class="menu-state" style="display: none;">
                <div class="menu-content">
                    <div class="logo-container">
                        <div class="logo-glow"></div>
                        <h1 id="menu-title">
                            <span class="title-main">HYPE</span>
                            <span class="title-accent">HERO</span>
                        </h1>
                        <div class="subtitle">Rhythm Gaming Experience</div>
                    </div>
                    
                    <div id="song-list">
                        <!-- Lista de músicas será preenchida dinamicamente -->
                    </div>
                    
                    <div class="menu-footer">
                        <div class="version-info">v1.0.0</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tela de Configurações -->
        <div id="settings-screen">
            <div class="menu-background">
                <div class="particles"></div>
                <div class="gradient-overlay"></div>
            </div>
            
            <button class="settings-back-btn" id="back-to-menu-btn">
                ◀
            </button>
            
            <h1 id="settings-title">CONFIGURAÇÕES</h1>
            <div class="settings-container">
                <div class="setting-item">
                    <div class="setting-label">Delay de Áudio</div>
                    <div class="setting-description">
                        Ajuste o delay para sincronizar o áudio com o visual. 
                        Use valores positivos se o áudio estiver atrasado, 
                        negativos se estiver adiantado.
                    </div>
                    <div class="setting-input">
                        <input type="number" id="audio-delay-input" value="40" min="-500" max="500" step="10">
                        <span class="setting-unit">ms</span>
                        <button class="auto-detect-btn" id="auto-detect-btn">Detectar Auto</button>
                    </div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-label">Velocidade das Notas</div>
                    <div class="setting-description">
                        Controla a velocidade de descida das notas. 
                        Devagar é mais fácil para iniciantes, rápido é mais desafiador.
                    </div>
                    <div class="setting-input">
                        <select id="note-speed-select">
                            <option value="slow">Devagar</option>
                            <option value="normal" selected>Normal</option>
                            <option value="fast">Rápido</option>
                        </select>
                    </div>
                </div>
                
                <div class="settings-buttons">
                    <button class="settings-btn primary" id="save-settings-btn">Salvar</button>
                    <button class="settings-btn secondary" id="cancel-settings-btn">Cancelar</button>
                </div>
            </div>
        </div>

        <!-- Tela de preparação -->
        <div id="start-screen">
            <div class="start-content">
                <h1 id="start-title"></h1>
                <h2 id="start-artist"></h2>
                <h3 id="start-difficulty"></h3>
                <button id="start-button">Iniciar</button>
                <p id="key-mapping"></p>
            </div>
        </div>

        <!-- Modal de pausa -->
        <div id="pause-modal">
            <div class="pause-title">JOGO PAUSADO</div>
            <div class="pause-buttons">
                <button class="pause-btn" id="resume-btn">Resumir</button>
                <button class="pause-btn" id="restart-btn">Recomeçar</button>
                <button class="pause-btn" id="exit-btn">Sair</button>
            </div>
        </div>

        <!-- Contagem regressiva -->
        <div id="countdown">
            <div id="countdown-number">3</div>
        </div>

        <!-- HUD da Gameplay -->
        <div id="ui-container">
            <div class="hud-stats">
                <div class="stat-item">
                    <div class="stat-value" id="score">0</div>
                    <div class="stat-label">SCORE</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="combo">0</div>
                    <div class="stat-label">COMBO</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="accuracy">100%</div>
                    <div class="stat-label">PRECISÃO</div>
                </div>
            </div>
            
            <!-- Botão pause -->
            <button id="pause-btn" class="hud-pause-btn" style="display: none;">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M10 9V15M14 9V15M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </button>
        </div>
        <canvas id="game-canvas"></canvas>
        
        <!-- Controles Touch para Mobile -->
        <div id="touch-controls">
            <div class="touch-lane" data-lane="0" style="border-color: #FF6347;"></div>
            <div class="touch-lane" data-lane="1" style="border-color: #90EE90;"></div>
            <div class="touch-lane" data-lane="2" style="border-color: #ADD8E6;"></div>
            <div class="touch-lane" data-lane="3" style="border-color: #FFD700;"></div>
            <div class="touch-lane" data-lane="4" style="border-color: #DA70D6;"></div>
        </div>
    </div>

    <!-- Modal de Detecção Automática de Delay -->
    <div id="auto-detect-modal">
        <div class="auto-detect-content">
            <div class="auto-detect-title">DETECÇÃO AUTOMÁTICA DE DELAY</div>
            <div class="auto-detect-instructions">
                Pressione <strong>ESPAÇO</strong> ou toque na área abaixo quando a barra vermelha cruzar a linha branca.
            </div>
            <div class="auto-detect-status" id="detect-status">Comece quando quiser!</div>
            
            <!-- Canvas para a interface visual de detecção -->
            <div class="detection-canvas-container">
                <canvas id="detection-canvas"></canvas>
            </div>
            
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>
            <div class="auto-detect-buttons">
                <button class="start-detection-btn" id="start-detection-btn">Iniciar Detecção</button>
                <button class="cancel-detection-btn" id="cancel-detection-btn">Cancelar</button>
            </div>
        </div>
    </div>

    <!-- Modal de Resultados -->
    <div id="results-modal">
        <div class="results-content">
            <div class="results-header">
                <div class="results-title">RESULTADOS</div>
                <div class="song-info">
                    <div class="song-title" id="results-song-title"></div>
                    <div class="song-difficulty" id="results-song-difficulty"></div>
                </div>
            </div>
            
            <div class="results-stats">
                <div class="stat-row main-score">
                    <div class="stat-label">SCORE</div>
                    <div class="stat-value" id="results-score">0</div>
                </div>
                
                <div class="stat-row">
                    <div class="stat-label">ACCURACY</div>
                    <div class="stat-value" id="results-accuracy">100%</div>
                </div>
                
                <div class="stat-row">
                    <div class="stat-label">MAX COMBO</div>
                    <div class="stat-value" id="results-combo">0</div>
                </div>
                
                <div class="stat-row">
                    <div class="stat-label">NOTAS ACERTADAS</div>
                    <div class="stat-value">
                        <span id="results-hit-notes">0</span> / <span id="results-total-notes">0</span>
                    </div>
                </div>
            </div>
            
            <div class="new-record" id="new-record-badge" style="display: none;">
                🏆 NOVO RECORD!
            </div>
            
            <div class="results-buttons">
                <button class="results-btn primary" id="restart-song-btn">Jogar Novamente</button>
                <button class="results-btn secondary" id="back-to-menu-from-results-btn">Menu Principal</button>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/6.5.9/browser/pixi.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.js"></script>

    <script src="index.js"></script>
</body>
</html>
